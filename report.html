<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Carlos A. Toruño Paniagua">

<title>Freedom and Institutions in Latin America and the Caribbean</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>
    .quarto-title-block .quarto-title-banner {
      color: white;
background: #264653;
    }
    </style>


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Freedom and Institutions in Latin America and the Caribbean</h1>
            <p class="subtitle lead"><em>Different perspectives torwards different realities</em></p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><em>Carlos A. Toruño Paniagua</em> </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#perceptions-of-discrimination" id="toc-perceptions-of-discrimination" class="nav-link active" data-scroll-target="#perceptions-of-discrimination">Perceptions of Discrimination</a></li>
  <li><a href="#criminal-justice-actors" id="toc-criminal-justice-actors" class="nav-link" data-scroll-target="#criminal-justice-actors">Criminal Justice Actors</a></li>
  <li><a href="#perceptions-criminal-justice-system" id="toc-perceptions-criminal-justice-system" class="nav-link" data-scroll-target="#perceptions-criminal-justice-system">Perceptions Criminal Justice System</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Latin America and the Caribbean is known for being the most unequal region in the world. As portrayed by <a href="https://publications.iadb.org/en/the-inequality-crisis-latin-america-and-the-caribbean-at-the-crossroads">this report</a> published by the Inter-American Development Bank, the region is characterized by a very high inequality in the income distribution and a fractured social contract. In the previous years, there has been a debate around how much does the high inequality in social and economic grounds that prevails in the region influence democratic and institutional aspects in the region <span class="citation" data-cites="krishna_inequality_2008">(see <a href="#ref-krishna_inequality_2008" role="doc-biblioref">Booth and Seligson 2008</a>)</span>.</p>
<p>In this report, Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
<section id="perceptions-of-discrimination" class="level2">
<h2 class="anchored" data-anchor-id="perceptions-of-discrimination">Perceptions of Discrimination</h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">2022 Overview</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Across Time Comparison</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP1a-label" for="inputP1a">
<h5 class="anchored">Select a variable:</h5>
</label>
<div>
<select id="inputP1a"><option value="q18a">Income</option>
<option value="q18b">Gender</option>
<option value="EXP_q17j">Age</option>
<option value="q18c">Ethnicity</option>
<option value="q18e">Nationality</option>
<option value="EXP_q17g" selected="">Skin Color</option>
<option value="EXP_q17h">Indigineous Origins</option>
<option value="q18f">Sexual Orientation</option></select>
<script type="application/json" data-for="inputP1a" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="discrimination_fig1" style="width:100%;height:750px;"></div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell panel-input card bg-light p-2 quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell no-overflow-x" style="flex-basis: 33.3%;justify-content: center;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP1b-label" for="inputP1b">
<h5 class="anchored">Country A:</h5>
</label>
<div>
<select id="inputP1b"><option value="Antigua and Barbuda">Antigua and Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Bahamas">Bahamas</option>
<option value="Barbados">Barbados</option>
<option value="Belize">Belize</option>
<option value="Bolivia">Bolivia</option>
<option value="Brazil">Brazil</option>
<option value="Chile">Chile</option>
<option value="Colombia">Colombia</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="Ecuador">Ecuador</option>
<option value="El Salvador">El Salvador</option>
<option value="Grenada">Grenada</option>
<option value="Guatemala">Guatemala</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Honduras">Honduras</option>
<option value="Jamaica">Jamaica</option>
<option value="Mexico">Mexico</option>
<option value="Nicaragua">Nicaragua</option>
<option value="Panama">Panama</option>
<option value="Paraguay">Paraguay</option>
<option value="Peru">Peru</option>
<option value="St. Kitts and Nevis">St. Kitts and Nevis</option>
<option value="St. Lucia">St. Lucia</option>
<option value="St. Vincent and the Grenadines">St. Vincent and the Grenadines</option>
<option value="Suriname">Suriname</option>
<option value="Trinidad and Tobago">Trinidad and Tobago</option>
<option value="Uruguay">Uruguay</option>
<option value="Venezuela">Venezuela</option>
<option value="LAC avg" selected="">LAC avg</option></select>
<script type="application/json" data-for="inputP1b" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display quarto-layout-cell no-overflow-x" style="flex-basis: 33.3%;justify-content: center;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP1c-label" for="inputP1c">
<h5 class="anchored">Country B:</h5>
</label>
<div>
<select id="inputP1c"><option value="Antigua and Barbuda">Antigua and Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Bahamas">Bahamas</option>
<option value="Barbados">Barbados</option>
<option value="Belize">Belize</option>
<option value="Bolivia">Bolivia</option>
<option value="Brazil">Brazil</option>
<option value="Chile">Chile</option>
<option value="Colombia">Colombia</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="Ecuador">Ecuador</option>
<option value="El Salvador">El Salvador</option>
<option value="Grenada">Grenada</option>
<option value="Guatemala">Guatemala</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Honduras">Honduras</option>
<option value="Jamaica">Jamaica</option>
<option value="Mexico">Mexico</option>
<option value="Nicaragua" selected="">Nicaragua</option>
<option value="Panama">Panama</option>
<option value="Paraguay">Paraguay</option>
<option value="Peru">Peru</option>
<option value="St. Kitts and Nevis">St. Kitts and Nevis</option>
<option value="St. Lucia">St. Lucia</option>
<option value="St. Vincent and the Grenadines">St. Vincent and the Grenadines</option>
<option value="Suriname">Suriname</option>
<option value="Trinidad and Tobago">Trinidad and Tobago</option>
<option value="Uruguay">Uruguay</option>
<option value="Venezuela">Venezuela</option>
<option value="LAC avg">LAC avg</option></select>
<script type="application/json" data-for="inputP1c" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display quarto-layout-cell no-overflow-x" style="flex-basis: 33.3%;justify-content: center;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP1d-label" for="inputP1d">
<h5 class="anchored">Select a variable:</h5>
</label>
<div>
<select id="inputP1d"><option value="q18a">Income</option>
<option value="q18b" selected="">Gender</option>
<option value="q18c">Ethnicity</option>
<option value="q18e">Nationality</option>
<option value="q18f">Sexual Orientation</option></select>
<script type="application/json" data-for="inputP1d" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="discrimination_fig2" style="width:100%;height:550px;"></div>
</div>
</div>
</div>
</div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP2a-label" for="inputP2a">
<h5 class="anchored">Select a variable:</h5>
</label>
<div>
<select id="inputP2a"><option value="inancia">Income</option>
<option value="ale">Gender</option>
<option value="kin" selected="">Skin Color</option></select>
<script type="application/json" data-for="inputP2a" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="discrimination_fig3" style="width:100%; height:750px; " class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme"></div>
</div>
</div>
<div class="cell" data-context="server">

</div>
</section>
<section id="criminal-justice-actors" class="level2">
<h2 class="anchored" data-anchor-id="criminal-justice-actors">Criminal Justice Actors</h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Trust</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Perceptions of Corruption</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP3a-label" for="inputP3a">
<h5 class="anchored">Select an actor:</h5>
</label>
<div>
<select id="inputP3a"><option value="q1d" selected="">Police</option>
<option value="q1e">Prosecutors</option>
<option value="q1f">Public Defense Attorneys</option>
<option value="q1g">Judges and Magistrates</option></select>
<script type="application/json" data-for="inputP3a" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<div class="checkbox">
<label>
<input id="inputP3b" type="checkbox">
<span>Show previous waves</span>
</label>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="actors_fig1" style="width:100%; height:550px; " class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme"></div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP3c-label" for="inputP3c">
<h5 class="anchored">Select an actor:</h5>
</label>
<div>
<select id="inputP3c"><option value="q2d" selected="">Police</option>
<option value="q2e">Prosecutors</option>
<option value="q2f">Public Defense Attorneys</option>
<option value="q2g">Judges and Magistrates</option></select>
<script type="application/json" data-for="inputP3c" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<div class="checkbox">
<label>
<input id="inputP3d" type="checkbox">
<span>Show previous waves</span>
</label>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="actors_fig2" style="width:100%; height:550px; " class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme"></div>
</div>
</div>
</div>
</div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<div class="cell panel-input card bg-light p-2 quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell no-overflow-x" style="flex-basis: 50.0%;justify-content: center;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP4a-label" for="inputP4a">
<h5 class="anchored">Select a country:</h5>
</label>
<div>
<select id="inputP4a"><option value="Antigua and Barbuda">Antigua and Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Bahamas">Bahamas</option>
<option value="Barbados" selected="">Barbados</option>
<option value="Bolivia">Bolivia</option>
<option value="Brazil">Brazil</option>
<option value="Colombia">Colombia</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="Ecuador">Ecuador</option>
<option value="Grenada">Grenada</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Jamaica">Jamaica</option>
<option value="Peru">Peru</option>
<option value="St. Kitts and Nevis">St. Kitts and Nevis</option>
<option value="St. Lucia">St. Lucia</option>
<option value="St. Vincent and the Grenadines">St. Vincent and the Grenadines</option>
<option value="Suriname">Suriname</option>
<option value="Trinidad and Tobago">Trinidad and Tobago</option>
<option value="Venezuela">Venezuela</option></select>
<script type="application/json" data-for="inputP4a" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display quarto-layout-cell no-overflow-x" style="flex-basis: 50.0%;justify-content: center;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP4b-label" for="inputP4b">
<h5 class="anchored">Disaggregate results by:</h5>
</label>
<div>
<select id="inputP4b"><option value="inancia">Income</option>
<option value="ale">Gender</option>
<option value="kin" selected="">Skin Color</option></select>
<script type="application/json" data-for="inputP4b" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="actors_fig3" style="width:100%; height:550px; " class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme"></div>
</div>
</div>
<div class="cell" data-context="server">

</div>
</section>
<section id="perceptions-criminal-justice-system" class="level2">
<h2 class="anchored" data-anchor-id="perceptions-criminal-justice-system">Perceptions Criminal Justice System</h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Year Comparisson</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Perceptions of Corruption</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP5a-label" for="inputP5a">
<h5 class="anchored">Select a country:</h5>
</label>
<div>
<select id="inputP5a"><option value="Antigua and Barbuda">Antigua and Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Bahamas">Bahamas</option>
<option value="Barbados">Barbados</option>
<option value="Belize">Belize</option>
<option value="Bolivia">Bolivia</option>
<option value="Brazil">Brazil</option>
<option value="Chile">Chile</option>
<option value="Colombia" selected="">Colombia</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="Ecuador">Ecuador</option>
<option value="El Salvador">El Salvador</option>
<option value="Grenada">Grenada</option>
<option value="Guatemala">Guatemala</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Honduras">Honduras</option>
<option value="Jamaica">Jamaica</option>
<option value="Mexico">Mexico</option>
<option value="Nicaragua">Nicaragua</option>
<option value="Panama">Panama</option>
<option value="Paraguay">Paraguay</option>
<option value="Peru">Peru</option>
<option value="St. Kitts and Nevis">St. Kitts and Nevis</option>
<option value="St. Lucia">St. Lucia</option>
<option value="St. Vincent and the Grenadines">St. Vincent and the Grenadines</option>
<option value="Suriname">Suriname</option>
<option value="Trinidad and Tobago">Trinidad and Tobago</option>
<option value="Uruguay">Uruguay</option>
<option value="Venezuela">Venezuela</option>
<option value="LAC avg">LAC avg</option></select>
<script type="application/json" data-for="inputP5a" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="perceptions_fig1" style="width:100%;height:550px;"></div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell panel-input card bg-light p-2 quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell no-overflow-x" style="flex-basis: 50.0%;justify-content: center;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP5b-label" for="inputP5b">
<h5 class="anchored">Select a country:</h5>
</label>
<div>
<select id="inputP5b"><option value="Antigua and Barbuda">Antigua and Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Bahamas">Bahamas</option>
<option value="Barbados" selected="">Barbados</option>
<option value="Bolivia">Bolivia</option>
<option value="Brazil">Brazil</option>
<option value="Colombia">Colombia</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="Ecuador">Ecuador</option>
<option value="Grenada">Grenada</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Jamaica">Jamaica</option>
<option value="Peru">Peru</option>
<option value="St. Kitts and Nevis">St. Kitts and Nevis</option>
<option value="St. Lucia">St. Lucia</option>
<option value="St. Vincent and the Grenadines">St. Vincent and the Grenadines</option>
<option value="Suriname">Suriname</option>
<option value="Trinidad and Tobago">Trinidad and Tobago</option>
<option value="Venezuela">Venezuela</option></select>
<script type="application/json" data-for="inputP5b" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display quarto-layout-cell no-overflow-x" style="flex-basis: 50.0%;justify-content: center;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inputP5c-label" for="inputP5c">
<h5 class="anchored">Disaggregate results by:</h5>
</label>
<div>
<select id="inputP5c"><option value="inancia">Income</option>
<option value="ale">Gender</option>
<option value="kin" selected="">Skin Color</option></select>
<script type="application/json" data-for="inputP5c" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="perceptions_fig2" style="width:100%;height:550px;"></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell" data-context="server">

</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
source("R/settings.R")

</script>
 
<script type="application/shiny-prerendered" data-context="data">
discrimination.ls <- list(
  "Overview"      = read_csv("Data/discrimination1.csv"),
  "Disaggregated" = read_csv("Data/discrimination2.csv") 
)

actors.ls <- list(
  "Overview"      = read_csv("Data/actors1.csv"),
  "Disaggregated" = read_csv("Data/actors2.csv") 
)

perceptions.ls <- list(
  "Overview"      = read_csv("Data/perceptions1.csv"),
  "Disaggregated" = read_csv("Data/perceptions2.csv") 
)

</script>
 
<script type="application/shiny-prerendered" data-context="server">
## ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
##
#                SERVER - DISCRIMINATION                                                                 ----
##
## ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

## Figure 1
output$discrimination_fig1 <- renderPlot({
  
  if (input$inputP1a == "EXP_q17g") {
    charac = "person with dark skin."
  }
  if (input$inputP1a == "q18a") {
    charac = "person with low incomes."
  }
  if (input$inputP1a == "q18b") {
    charac = "woman."
  }
  if (input$inputP1a == "EXP_q17j") {
    charac = "young person."
  }
  if (input$inputP1a == "q18c") {
    charac = "person of a different ethnicity."
  }
  if (input$inputP1a == "q18e") {
    charac = "foregeiner or immigrant."
  }
  if (input$inputP1a == "EXP_q17h") {
    charac = "a person with indigineous origins."
  }
  if (input$inputP1a == "q18f") {
    charac = "a member of the LGBT community."
  }
  
  discrimination.ls[["Overview"]] %>%
    filter(year == 2022) %>%
    select(country, all_of(input$inputP1a)) %>%
    rename(target  = 2) %>%
    mutate(color = if_else(country == "LAC avg",
                           "Regional",
                           "Country")) %>%
    ggplot(aes(x    = reorder(country, target),
               y    = target,
               fill = color)) +
    geom_bar(stat   = "identity",
             show.legend = F) +
    labs(title    = "Perceptions of Police Bias in Latin America and the Caribbean",
         subtitle = paste("Percentage of people who believe that the local police would be negatively biased",
                          "\ntowards a", charac),
         y        = "% of Respondents",
         caption  = "**Source**: General Population Poll 2021-2022") +
    scale_fill_manual(values = c("Regional" = "#3B341F",
                                 "Country"  = "#A5CBC3")) +
    scale_y_continuous(limits = c(0,100),
                       breaks = seq(0, 100, 20)) +
    coord_flip() +
    WJP_theme() +
    theme(panel.grid.major.y = element_blank(),
          axis.title.y       = element_blank())
})

## Figure 2
output$discrimination_fig2 <- renderPlot({

  if (input$inputP1d == "q18a") {
    charac = "person with low incomes."
  }
  if (input$inputP1d == "q18b") {
    charac = "woman."
  }
  if (input$inputP1d == "q18c") {
    charac = "person of a different ethnicity."
  }
  if (input$inputP1d == "q18e") {
    charac = "foregeiner or immigrant."
  }
  if (input$inputP1d == "q18f") {
    charac = "a member of the LGBT community."
  }
  
  discrimination.ls[["Overview"]] %>%
    filter(country %in% c(input$inputP1b, input$inputP1c)) %>%
    select(country, year, all_of(input$inputP1d)) %>%
    rename(target  = 3) %>%
    mutate(color = if_else(country == input$inputP1b,
                           "Country A",
                           "Country B")) %>%
    ggplot(aes(x     = year,
               y     = target,
               color = country)) +
    geom_point(size  = 2.25) +
    geom_line(size   = 1.25) +
    labs(title    = "Perceptions of Police Bias in Latin America and the Caribbean",
         subtitle = paste("Percentage of people who believe that the local police would be negatively biased",
                          "\ntowards a", charac),
         y        = "% of Respondents",
         caption  = paste0("**Source**: General Population Poll 2021-2022<br>",
                           "**Note**: Time series are not available for perceptions based on skin color, age and indigineous origins.")) +
    scale_color_manual(values = c( "#264653", "#F4A261")) +
    scale_y_continuous(limits = c(0,100),
                       breaks = seq(0, 100, 20)) +
    scale_x_continuous(limits = c(2012, 2022),
                       breaks = seq(2012, 2022, 2),
                       labels = as.character(seq(2012, 2022, 2))) +
    WJP_theme() +
    theme(panel.grid.major.x = element_blank(),
          axis.title.x       = element_blank(),
          legend.position    = "top",
          legend.key         = element_rect(fill = "white"))
})

## Figure 3
output$discrimination_fig3 <- renderPlotly({
  
  if (input$inputP2a == "inancia") {
    charac = "person with low incomes."
  }
  if (input$inputP2a == "ale") {
    charac = "woman."
  }
  if (input$inputP2a == "kin") {
    charac = "person of dark skin."
  }
  
  ggplotly(
    discrimination.ls[["Disaggregated"]] %>%
      filter(str_detect(category, 
                        input$inputP2a)) %>%
      ggplot(aes(color = category,
                 x     = reorder(country, mean),
                 y     = mean,
                 text  = paste0("Percentage: ", 
                                format(round(mean, 0), 
                                       nsmall = 0), 
                                "%"))) +
      geom_point(size = 2) +
      geom_segment(aes(x    = country,
                       xend = country,
                       y    = lower,
                       yend = upper),
                   alpha    = 0.7,
                   show.legend = F) +
      labs(y        = "% of Respondents",
           caption  = paste0("**Source**: General Population Poll 2021-2022<br>",
                             "**Note**: Disaggregations are only possible between genders, income and skin color")) +
      scale_color_manual(values = c("#70161E",
                                    "#596F62")) +
      coord_flip() +
      WJP_theme() +
      theme(axis.title.y    = element_blank(),
            axis.title.x    = element_text(size  = 9),
            axis.text.x     = element_text(size  = 8),
            axis.text.y     = element_text(size  = 8,
                                           hjust = 0),
            plot.title      = element_text(size  = 13),
            legend.text     = element_text(size  = 8), 
            legend.key      = element_rect(fill  = "white"),
            legend.position = "bottom",
            legend.title    = element_blank()),
    tooltip = c("text")
  ) %>%
    layout(title  = list(text  = paste0("Difference in Perceptions between Sociodemographic Groups<br>",
                                        "<sup style='font-family:Lato;font-style:italic'>", 
                                        "Percentage of people who believe the police would be neg. biased ",
                                        "towards a ", charac, 
                                        "<\u002fsup>"),
                         font   = list(family = "Lato",
                                       size   = 17),
                         x      = 0),
           legend = list(title  = "",
                         x      = 0.3,
                         orientation = "h"),
           xaxis = list(fixedrange = T), 
           yaxis = list(fixedrange = T)) %>%
  config(displayModeBar = F)
})

</script>
 
<script type="application/shiny-prerendered" data-context="server">
## ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
##
#                SERVER - CRIMINAL JUSTICE ACTORS                                                        ----
##
## ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

output$actors_fig1 <- renderPlotly({
  
  if (input$inputP3b == T) {
    yrs <- c("2017-2019", "2021-2022")
  } else {
    yrs <- c("2021-2022")
  }
  
  if (input$inputP3a == "q1d") {
    charac <- "police officers"
  }
  if (input$inputP3a == "q1e") {
    charac <- "public prosecutors"
  }
  if (input$inputP3a == "q1f") {
    charac <- "public defense attorneys"
  }
  if (input$inputP3a == "q1g") {
    charac <- "judges and magistrates"
  }
  
  data2plot <- actors.ls[["Overview"]] %>%
    mutate(
      secyear = year, 
      year = case_when(
        year >= 2021 & year <= 2022 ~ "2021-2022",
        year >= 2017 & year <= 2019 ~ "2017-2019",
      )
    ) %>%
    filter(year %in% yrs) %>%
    select(country, year, all_of(input$inputP3a), secyear) %>%
    rename(value2plot = 3) %>%
    group_by(country) %>%
    mutate(maxval  = if_else(year == "2021-2022", 1, NA_real_),
           maxval  = value2plot*maxval,
           maxval  = max(maxval, na.rm = T))
  
  plot <- ggplot(data = data2plot,
                 aes(x     = reorder(country, maxval),
                     y     = value2plot,
                     color = year,
                     text  = paste0(country, ": ", secyear, "<br>",
                                    "Percentage: ", 
                                    format(round(value2plot, 0), 
                                           nsmall = 0), 
                                    "%")))
  
  if (input$inputP3b == T) {
    plot <- plot +
      geom_segment(aes(xend = reorder(country, maxval),
                       y    = value2plot,
                       yend = maxval),
                   color    = "#F4A261",
                   alpha    = 0.75,
                   show.legend = F)
  }
  
  plot <- plot +
    geom_point(size = 2) +
    labs(y = "% of Respondents") +
    scale_color_manual(values = c("2021-2022" = "#264653", 
                                  "2017-2019" = "#F4A261")) +
    scale_y_continuous(limits = c(0,100),
                       breaks = seq(0, 100, 20)) +
    coord_flip() +
    WJP_theme() +
    theme(axis.title.y       = element_blank(),
          axis.title.x       = element_text(size  = 9),
          axis.text.x        = element_text(size  = 8),
          axis.text.y        = element_text(size  = 8,
                                            hjust = 0),
          panel.grid.major.y = element_blank(),
          plot.title         = element_text(size  = 13),
          legend.text        = element_text(size  = 8), 
          legend.key         = element_rect(fill  = "white"),
          legend.position    = "bottom",
          legend.title       = element_blank())
  
  ggplotly(plot, 
           tooltip = c("text")
  ) %>%
    layout(
      title  = list(text  = paste0("Trust in ", charac, " in Latin America and the Caribbean<br>",
                                   "<sup style='font-family:Lato;font-style:italic'>", 
                                   "Percentage of respondents who affirmed to have a lot or some trust in ", charac, 
                                   ".<\u002fsup>"),
                    font   = list(family = "Lato",
                                  size   = 17),
                    x      = 0),
      legend = list(title  = "",
                    x      = 0.3,
                    orientation = "h"),
      xaxis  = list(fixedrange = T), 
      yaxis  = list(fixedrange = T),
      margin = list(t   = 50,
                    r   = 50,
                    b   = 20, 
                    l   = 50,
                    pad = 0)
    ) %>%
  config(displayModeBar = F)
})

output$actors_fig2 <- renderPlotly({
  
  if (input$inputP3d == T) {
    yrs <- c("2017-2019", "2021-2022")
  } else {
    yrs <- c("2021-2022")
  }
  
  if (input$inputP3c == "q2d") {
    charac <- "police officers"
  }
  if (input$inputP3c == "q2e") {
    charac <- "public prosecutors"
  }
  if (input$inputP3c == "q2f") {
    charac <- "public defense attorneys"
  }
  if (input$inputP3c == "q2g") {
    charac <- "judges and magistrates"
  }
  
  data2plot <- actors.ls[["Overview"]] %>%
    mutate(
      secyear = year, 
      year = case_when(
        year >= 2021 & year <= 2022 ~ "2021-2022",
        year >= 2017 & year <= 2019 ~ "2017-2019",
      )
    ) %>%
    filter(year %in% yrs) %>%
    select(country, year, all_of(input$inputP3c), secyear) %>%
    rename(value2plot = 3) %>%
    group_by(country) %>%
    mutate(maxval  = if_else(year == "2021-2022", 1, NA_real_),
           maxval  = value2plot*maxval,
           maxval  = max(maxval, na.rm = T))
  
  plot <- ggplot(data = data2plot,
                 aes(x     = reorder(country, maxval),
                     y     = value2plot,
                     color = year,
                     text  = paste0(country, ": ", secyear, "<br>",
                                    "Percentage: ", 
                                    format(round(value2plot, 0), 
                                           nsmall = 0), 
                                    "%")))
  
  if (input$inputP3d == T) {
    plot <- plot +
      geom_segment(aes(xend = reorder(country, maxval),
                       y    = value2plot,
                       yend = maxval),
                   color    = "#F4A261",
                   alpha    = 0.75,
                   show.legend = F)
  }
  
  plot <- plot +
    geom_point(size = 2) +
    labs(y = "% of Respondents") +
    scale_color_manual(values = c("2021-2022" = "#264653", 
                                  "2017-2019" = "#F4A261")) +
    scale_y_continuous(limits = c(0,100),
                       breaks = seq(0, 100, 20)) +
    coord_flip() +
    WJP_theme() +
    theme(axis.title.y       = element_blank(),
          axis.title.x       = element_text(size  = 9),
          axis.text.x        = element_text(size  = 8),
          axis.text.y        = element_text(size  = 8,
                                            hjust = 0),
          panel.grid.major.y = element_blank(),
          plot.title         = element_text(size  = 13),
          legend.text        = element_text(size  = 8), 
          legend.key         = element_rect(fill  = "white"),
          legend.position    = "bottom",
          legend.title       = element_blank())
  
  ggplotly(plot, 
           tooltip = c("text")
  ) %>%
    layout(
      title  = list(text  = paste0("Corruption perceptions of", charac, " in Latin America and the Caribbean<br>",
                                   "<sup style='font-family:Lato;font-style:italic'>", 
                                   "Percentage of respondents who believe that all or most ", charac, 
                                   " are involved in corrupt practices.<\u002fsup>"),
                    font   = list(family = "Lato",
                                  size   = 17),
                    x      = 0),
      legend = list(title  = "",
                    x      = 0.3,
                    orientation = "h"),
      xaxis  = list(fixedrange = T), 
      yaxis  = list(fixedrange = T),
      margin = list(t   = 50,
                    r   = 50,
                    b   = 20, 
                    l   = 50,
                    pad = 0)
    ) %>%
  config(displayModeBar = F)
})

output$actors_fig3 <- renderPlotly({
  
  data2plot <- actors.ls[["Disaggregated"]] %>%
    filter(country == input$inputP4a & str_detect(category, input$inputP4b))
  
  vals <- data2plot %>%
    select(starts_with("mean_")) %>%
    rename(`Trust:<br>Police`                        = mean_q1d, 
           `Trust:<br>Prosecutors`                   = mean_q1e,
           `Trust:<br>Public Defense Attorneys`      = mean_q1f,
           `Trust:<br>Judges & Magistrates`          = mean_q1g,
           `Corruption:<br>Police`                   = mean_q2d,
           `Corruption:<br>Prosecutors`              = mean_q2e,
           `Corruption:<br>Public Defense Attorneys` = mean_q2f,
           `Corruption:<br>Judges & Magistrates`     = mean_q2g)
  
  plot_ly(
    type = 'scatterpolar',
    fill = 'toself'
  ) %>%
    add_trace(
      r         = as.numeric(vals[1,]),
      theta     = names(vals),
      name      = (data2plot$category)[1],
      fillcolor = "#70161E",
      line      = list(color   = "#70161E"),
      marker    = list(color   = "#70161E",
                       opacity = 1),
      opacity = 0.5
    ) %>%
    add_trace(
      r     = as.numeric(vals[2,]),
      theta = names(vals),
      name  = (data2plot$category)[2],
      fillcolor = "#596F62",
      line      = list(color   = "#596F62"),
      marker    = list(color   = "#596F62",
                       opacity = 1),
      opacity = 0.5
    )  %>%
    layout(
      title  = list(text  = paste0("Trust and Corruption in Selected Institutions across LAC<br>",
                                   "<sup style='font-family:Lato;font-style:italic'>", 
                                   "Percentages disaggregated by sociodemographic group<\u002fsup>"),
                    font   = list(family = "Lato",
                                  size   = 16),
                    x      = 0),
      polar = list(
        radialaxis = list(
          visible  = T,
          range    = c(0,100)
        ),
        margin = list(t   = 200,
                      r   = 40,
                      b   = 40, 
                      l   = 40,
                      pad = 40,
                      autoexpand = F) ,
        xaxis  = list(fixedrange = T), 
        yaxis  = list(fixedrange = T)
      )
    )
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
## ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
##
#                SERVER - Perceptions Criminal Justice System                                                        ----
##
## ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


output$perceptions_fig1 <- renderPlot({
  
  yrs <- perceptions.ls[["Overview"]] %>%
  filter(country %in% input$inputP5a) %>%
  slice_max(order_by = group, n = 2) %>%
  pull(group)
  
  data2plot <- perceptions.ls[["Overview"]] %>%
    filter(country %in% input$inputP5a)
  data2plot <- data2plot[,2:8]
  
  # Definig labels - Part I: Percentages
  vals <- data2plot %>% 
    filter(group == yrs[1]) %>%
    pivot_longer(!group,
                 values_to = "values",
                 names_to  = "vars") %>%
    pull(values)

  vals <- paste0(round(vals*100,0), "%")
  names(vals) <- names(data2plot %>% select(!group))
  
  # Defining color palette
  colors4plot <- c("#264653", "#F4A261")
  names(colors4plot) <- yrs
  
  applying_labels.fn <- function(text = text, color_code, value_vectors){
  case_when(
    text == 'q48e_G1' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                           value_vectors["q48e_G1"],
                           "<\u002fspan>",
                           "<br>",
                           "<span style='color:#524F4C;font-size:3.514598mm;font-weight:bold'>",
                           "The courts **guarantee** everyone<br> a fair trial",
                           "<\u002fspan>"),
    text == 'q48f_G1' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48f_G1"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "The courts are more concerned <br> about *procedures* than they <br> are with providing justice",
                              "<\u002fspan>"),
    text == 'q48g_G1' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48g_G1"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "The courts decides according <br>to the *interes* of those <br>innocence who have more money",
                              "<\u002fspan>"),
    text == 'q48e_G2' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48e_G2"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "Police investigators **investigate crimes <br> in an independent manner**",
                              "<\u002fspan>"),
    text == 'q48f_G2' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48f_G2"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "Prosecutors **prosecute crimes <br> in an independent manner**",
                              "<\u002fspan>"),
    text == 'q48g_G2' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                                    value_vectors["q48g_G2"],
                                    "<\u002fspan>",
                                    "<br>",
                                    "<span style='color:#524F4C;font-size:3.514598mm'>",
                                    "Judges **decides cases <br> in an independent manner**",
                                    "<\u002fspan>")
  )
  }
  
  base_figure <- ggradar2::ggradar2(
  data2plot,
  radarshape  = "sharp",
  fullscore   = rep(1, 6),
  polygonfill = F,
  background.circle.colour = "white",
  gridline.mid.colour      = "grey",
  gridline.min.linetype    = "solid",
  gridline.mid.linetype    = "solid",
  gridline.max.linetype    = "solid",
  grid.label.size = 3.514598,
  
  # The following part is IMPORTANT. We define the labels using a markdown syntax. However, given that
  # ggradar2 uses geom_text(), markdown language is not supported and all the italics or bold fonts. 
  # will not be reflected. Therefore, we set labels with color == "white" so they are not visible  
  # However, ggradar estimates the optimal X and Y coordinates of these labels and saves them as plot data.
  # We gonna use these coordinates to plot these labels again but using ggtext::geom_richtext which
  # supports markdown syntax in the labels.
  
  axis.labels.color = "white",
  axis.label.size  = 1,
  group.colours    = colors4plot,
  group.line.width = 0.75
)

# Transforming labels using an externally predefined function
base_figure$data <- base_figure$data %>%
  mutate(across(text,
                applying_labels.fn ,
                color_code    = colors4plot[1],
                value_vectors = vals))

# Adding additional aesthetics to radar chart using the "traditional" tools from ggplot2
radar <- base_figure +
  ggtext::geom_richtext(data  = base_figure$data,
                        # For the aesthetics, we bring the X and Y coordinates saved by ggradar2 with
                        # a minor adjustment depending on the final position of the label.
                        aes(x     = x*c(1.0, 1.2, 1.17, 1.12, 1.0, 1.1), 
                            y     = y*c(1.1, 1.2, 1.10, 1.12, 1.1, 1.1), 
                            label = text),
                        #family      = "Lato Full",
                        fontface    = "plain",
                        hjust       = 0.5, 
                        size        = 3.514598,
                        text.colour = "#524F4C", 
                        fill        = NA, 
                        label.color = NA) +
  scale_y_continuous(expand = expansion(mult = 0.065)) +
  theme(legend.position = "top");radar

})


output$perceptions_fig2 <- renderPlot({
  
  data2plot <- perceptions.ls[["Disaggregated"]] %>%
    filter(group %in% input$inputP5b) %>%
    filter(str_detect(category, input$inputP5c))
  
  yrs <- data2plot %>%
    pull(category) %>%
    unique()
  
  data2plot <- data2plot[,2:8] %>%
    rename(group = category)
  
  # Definig labels - Part I: Percentages
  
  vals <- data2plot %>% 
    filter(group == yrs[1]) %>%
    pivot_longer(!group,
               values_to = "values",
               names_to  = "vars") %>%
    pull(values)
  
  vals <- paste0(round(vals*100,0), "%")
  names(vals) <- names(data2plot %>% select(!group))

  # Defining color palette
  colors4plot <- c("#264653", "#F4A261")
  names(colors4plot) <- yrs
  
  applying_labels.fn <- function(text = text, color_code, value_vectors){
  case_when(
    text == 'q48e_G1' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                           value_vectors["q48e_G1"],
                           "<\u002fspan>",
                           "<br>",
                           "<span style='color:#524F4C;font-size:3.514598mm;font-weight:bold'>",
                           "The courts **guarantee** everyone<br> a fair trial",
                           "<\u002fspan>"),
    text == 'q48f_G1' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48f_G1"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "The courts are more concerned <br> about *procedures* than they <br> are with providing justice",
                              "<\u002fspan>"),
    text == 'q48g_G1' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48g_G1"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "The courts decides according <br>to the *interes* of those <br>innocence who have more money",
                              "<\u002fspan>"),
    text == 'q48e_G2' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48e_G2"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "Police investigators **investigate crimes <br> in an independent manner**",
                              "<\u002fspan>"),
    text == 'q48f_G2' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                              value_vectors["q48f_G2"],
                              "<\u002fspan>",
                              "<br>",
                              "<span style='color:#524F4C;font-size:3.514598mm'>",
                              "Prosecutors **prosecute crimes <br> in an independent manner**",
                              "<\u002fspan>"),
    text == 'q48g_G2' ~ paste("<span style='color:", color_code, ";font-size:6.326276mm;font-weight:bold'>",  
                                    value_vectors["q48g_G2"],
                                    "<\u002fspan>",
                                    "<br>",
                                    "<span style='color:#524F4C;font-size:3.514598mm'>",
                                    "Judges **decides cases <br> in an independent manner**",
                                    "<\u002fspan>")
  )
  }
  
  base_figure <- ggradar2::ggradar2(
  data2plot,
  radarshape  = "sharp",
  fullscore   = rep(1, 6),
  polygonfill = F,
  background.circle.colour = "white",
  gridline.mid.colour      = "grey",
  gridline.min.linetype    = "solid",
  gridline.mid.linetype    = "solid",
  gridline.max.linetype    = "solid",
  grid.label.size = 3.514598,
  
  # The following part is IMPORTANT. We define the labels using a markdown syntax. However, given that
  # ggradar2 uses geom_text(), markdown language is not supported and all the italics or bold fonts. 
  # will not be reflected. Therefore, we set labels with color == "white" so they are not visible  
  # However, ggradar estimates the optimal X and Y coordinates of these labels and saves them as plot data.
  # We gonna use these coordinates to plot these labels again but using ggtext::geom_richtext which
  # supports markdown syntax in the labels.
  
  axis.labels.color = "white",
  axis.label.size  = 1,
  group.colours    = colors4plot,
  group.line.width = 0.75
)

# Transforming labels using an externally predefined function
base_figure$data <- base_figure$data %>%
  mutate(across(text,
                applying_labels.fn ,
                color_code    = colors4plot[1],
                value_vectors = vals))

# Adding additional aesthetics to radar chart using the "traditional" tools from ggplot2
radar <- base_figure +
  ggtext::geom_richtext(data  = base_figure$data,
                        # For the aesthetics, we bring the X and Y coordinates saved by ggradar2 with
                        # a minor adjustment depending on the final position of the label.
                        aes(x     = x*c(1.0, 1.2, 1.17, 1.12, 1.0, 1.1), 
                            y     = y*c(1.1, 1.2, 1.10, 1.12, 1.1, 1.1), 
                            label = text),
                        #family      = "Lato Full",
                        fontface    = "plain",
                        hjust       = 0.5, 
                        size        = 3.514598,
                        text.colour = "#524F4C", 
                        fill        = NA, 
                        label.color = NA) +
  scale_y_continuous(expand = expansion(mult = 0.065)) +
  theme(legend.position = "top");radar
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.5.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.5.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.10.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.5.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.5.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.10.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.5.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.5.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.10.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.5.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.5.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.10.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","bit","bit64","broom","bslib","cellranger","cli","colorspace","compiler","crayon","curl","data.table","datasets","DBI","dbplyr","digest","dplyr","ellipsis","evaluate","fansi","fastmap","forcats","fs","generics","ggplot2","ggtext","glue","graphics","grDevices","grid","gridtext","gtable","haven","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","knitr","later","lazyeval","lifecycle","lubridate","magrittr","methods","mime","modelr","munsell","parallel","pillar","pkgconfig","plotly","promises","purrr","R6","Rcpp","readr","readxl","reprex","rlang","rmarkdown","rstudioapi","rvest","sass","scales","shiny","shinyWidgets","showtext","showtextdb","stats","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","tools","tzdb","utf8","utils","vctrs","viridisLite","vroom","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.4.1","4.2.2","4.0.4","4.0.5","0.8.0","0.3.1","1.1.0","3.6.0","2.0-3","4.2.2","1.5.1","4.3.2","1.14.2","4.2.2","1.1.2","2.1.1","0.6.29","1.0.9","0.3.2","0.15","1.0.3","1.1.0","0.5.1","1.5.2","0.1.2","3.4.0","0.1.1","1.6.2","4.2.2","4.2.2","4.2.2","0.1.4","0.3.1","2.5.0","1.1.1","0.5.4","1.5.4","1.6.5","1.4.3","0.1.4","1.8.0","1.39","1.3.0","0.2.2","1.0.3","1.8.0","2.0.3","4.2.2","0.12","0.1.8","0.5.0","4.2.2","1.8.1","2.0.3","4.10.0","1.2.0.1","0.3.4","2.5.1","1.0.8.3","2.1.2","1.4.0","2.0.1","1.0.6","2.14","0.13","1.0.2","0.4.1","1.2.1","1.7.4","0.7.3","0.9-5","3.0","4.2.2","1.7.6","1.4.0","0.8.8","3.1.8","1.2.0","1.1.2","1.3.1","4.2.2","0.3.0","1.2.2","4.2.2","0.5.1","0.4.1","1.5.7","2.5.0","0.31","1.3.3","1.8-4","2.3.5"]}]}]}
</script>
<!--/html_preserve-->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-krishna_inequality_2008" class="csl-entry" role="doc-biblioentry">
Booth, John A., and Mitchell A. Seligson. 2008. <span>“Inequality and <span>Democracy</span> in <span>Latin</span> <span>America</span>: <span>Individual</span> and <span>Contextual</span> <span>Effects</span> of <span>Wealth</span> on <span>Political</span> <span>Participation</span>.”</span> In <em>Poverty, <span>Participation</span>, and <span>Democracy</span>: <span>A</span> <span>Global</span> <span>Perspective</span></em>, edited by Anirudh Krishna, 94–124. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511756160.006">https://doi.org/10.1017/CBO9780511756160.006</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>